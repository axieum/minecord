plugins {
    id 'com.github.johnrengelman.shadow' version '7.0.0'
}

apply plugin: 'com.github.johnrengelman.shadow'
configurations { shadow; implementation.extendsFrom shadow }

// Declare dependencies
dependencies {
    implementation project(path: ':minecord-api', configuration: 'shadow')
    shadow "com.vdurmont:emoji-java:${project.emoji_java_version}"
    shadow "io.github.java-diff-utils:java-diff-utils:${project.java_diff_utils_version}"
}

// Produce a fat-jar of all the shaded dependencies
shadowJar {
    archiveClassifier = 'dev'
    configurations = [project.configurations.shadow]

    // Relocate dependencies
    final dest = "${project.group}.shadow.chat"

    // Minify the result - remove unused classes
    minimize()
}

// Provide the fat-jar to Fabric's remapping task
remapJar {
    dependsOn tasks.shadowJar
    input.set(tasks.shadowJar.archiveFile)
}
